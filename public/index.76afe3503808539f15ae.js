(()=>{"use strict";class e{static create(n){return fetch("https://application-with-authorization-default-rtdb.europe-west1.firebasedatabase.app/question.json",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>(n.id=e.name,n))).then(t).then(e.renderList)}static fetch(e){return e?fetch(`https://application-with-authorization-default-rtdb.europe-west1.firebasedatabase.app/question.json?auth=${e}`).then((e=>e.json())).then((e=>e&&e.error?`<p class="error">${e.error}</p>`:e?Object.keys(e).map((t=>({...e[t],id:t}))):[])):Promise.resolve('<p class="error">У вас нет токена</p>')}static renderList(){const e=n(),t=e.length?e.map(i).join(""):'<div class="mui--text=headline">Вы пока ничего не спрашивали</div>';document.getElementById("list").innerHTML=t}static listToHTML(e){return e.length?`<ol>${e.map((e=>`<li>${e.text}</li>`)).join("")}</ol>`:"<p>Вопросов пока нет</p>"}}function t(e){const t=n();t.push(e),localStorage.setItem("questions",JSON.stringify(t))}function n(){return JSON.parse(localStorage.getItem("questions")||"[]")}function i(e){return`\n    <div class="mui--text-black-54">\n      ${new Date(e.date).toLocaleDateString()}\n      ${new Date(e.date).toLocaleTimeString()}\n    </div>\n    <div>${e.text}</div>\n    <br>\n  `}function a(e){return e.length>=10}function o(e,t){const n=document.createElement("div");n.classList.add("modal"),n.innerHTML=`\n    <h1>${e}</h1>\n    <div class="modal-content">${t}</div>\n  `,mui.overlay("on",n)}const s=document.getElementById("form"),r=document.getElementById("modal-btn"),l=s.querySelector("#question-input"),d=s.querySelector("#submit");function u(t){t.preventDefault();const n=t.target.querySelector("button"),i=t.target.querySelector("#email").value,a=t.target.querySelector("#password").value;n.disabled=!0,function(e,t){return fetch("https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyAWCwF5St4BRsHxecWYRk0WR5SZGzzxzs0",{method:"POST",body:JSON.stringify({email:e,password:t,returnSecureToken:!0}),headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>e.idToken))}(i,a).then(e.fetch).then(c).then((()=>n.disabled=!1))}function c(t){"string"==typeof t?o("Ошибка!",t):o("Список вопросов",e.listToHTML(t))}window.addEventListener("load",e.renderList),s.addEventListener("submit",(function(t){if(t.preventDefault(),a(l.value)){const t={text:l.value.trim(),date:(new Date).toJSON()};d.disabled=!0,e.create(t).then((()=>{l.value="",l.className="",d.disabled=!1}))}})),r.addEventListener("click",(function(e){o("Авторизация",'\n  <form class="mui-form" id="auth-form">\n    <div class="mui-textfield mui-textfield--float-label">\n      <input id="email" type="email" required>\n      <label for="email">Email</label>\n    </div>\n    <div class="mui-textfield mui-textfield--float-label">\n      <input id="password" type="password" required>\n      <label for="password">Пароль</label>\n    </div>\n    <button class="mui-btn mui-btn--raised mui-btn--primary" type="submit">Войти</button>\n  </form>\n  '),document.getElementById("auth-form").addEventListener("submit",u,{once:!0})})),l.addEventListener("input",(()=>{d.disabled=!a(l.value)}))})();